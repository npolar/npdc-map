<!DOCTYPE html>
<article ng-show="document" layout-padding>
  <header>
    {{ document.preamble }}
    <h4><a ng-href="archive/?filter-type={{document.type}}">{{document.type}}</a> map <span ng-if="document.restricted">[restricted access]</span></h4>
    <h1 ng-if="!formula" class="md-display-2">{{ img.title(document) }} </h1>
    
    {{ document.subtitle}}
    
    <!-- {{ principalInvestigators(document.contributors) | json }} -->
    
    <!-- <h3>
      <a href="?filter-publication.publisher={{document.publication.publisher}}">{{ document.publishers[0].name }}</a>
    </h3> -->
    
    <div ng-if="formula">
      <npdc:formula></npdc:formula>
    </div>
    <div ng-if="!formula">
      <npdc:edit-button class="np-primary-control"></npdc:edit-button>
    </div>
 
    <span ng-if="document.restricted === true && rightsHolders">
      © {{ rightsHolders.join(' / ') }}
    </span>
    <!-- publisher -->
    <!-- <span ng-if="document.series">
      / series: <a ng-href="?filter-publication.series={{document.publication.series}}">{{ document.publication.series }}</a> / type: <a ng-href="?q=&filter-type={{document.type}}">{{document.type}}</a>
    </span>

      <span ng-if="document.publication.code">
        / code: <a ng-href="?filter-publication.code={{document.publication.code}}">{{ document.publication.code }}</a>
      </span>

     <span ng-if="true">
        / scale: <a ng-href="?filter-scale={{document.scale}}">1:{{document.scales|json}}</a>
      </span>
    -->
    <!--
      / published: <a ng-href="?filter-publication.year={{document.publication.year}}">{{ year(document.publication.year) }}</a> in <a ng-href="?filter-publication.country={{document.publication.country | uppercase }}">{{ document.publication.country }}</a>
    -->
       <!-- / access: <a href="?filter-restricted={{ document.restricted == true ? 'true' : 'false' }}">{{ document.restricted == true ? 'restricted' : 'open' }}</a>-->
       
    <span ng-repeat="publisher in document.publishers">
      {{publisher.name}}
    </span>
    
  </header>

  <section ng-if="document.files">
      <span ng-if="document.files.length > 0" ng-repeat="image in document.files">
        <a ng-href="{{ img.large(image, document)}}">
          <img ng-src="{{ img.icon(image, document)}}"
            width="400"
            alt="{{img.basename(image.filename)}}"
            title="{{img.basename(image.filename)}}" />
        </a>
      </span>
  </section>
  
  <section ng-if="document.geometry && document.geometry.bbox">
    
    
    <leaflet ng-if="document && mapOptions.coverage" options="mapOptions" class="coverage-map" style="height: 600px;"></leaflet>
    <b>bbox</b>
    {{ document.geometry.bbox | json }}
    
  </section>
  
  <section ng-if="document.scales">
    <h3>Målestokk</h3>
    <span ng-repeat="scale in document.scales">
      1:{{scale}} |
    </span>
  </section>

  <section ng-if="document.summaries">
     <h3>Summary</h3>
     <p ng-repeat="s in document.summaries">{{ s.summary }} [{{ s.lang }}]</p>  
  </section>
  
   <section ng-if="document.comments">
    <h3>Comment</h3>
    <p ng-repeat="c in document.comments">{{ c.comment}} [{{ c.lang }}]</p>
  </section>



    </section>
  

  
  <section ng-if="document.files"><!--&& document.license ? -->
    
    <md-divider></md-divider>
    <h2>
      <md-icon>file_download</md-icon>Download </h2>
    
    <h3>High quality</h3>
      <table>
<!--        <th>
          <tr>Original (HQ)</tr>
          <tr>JPEG</tr>
        </th>-->
      <tr ng-repeat="image in images"> 
          <td><md-icon title="{{image.length | bytes }} - {{image.type }}">image</md-icon></td>
          <td>
            <a ng-if="document.license || security.hasSystem(resource.path)" download ng-href="{{image.uri}}{{ (key().length > 64) ? '?key='+key() : ''}}">{{image.filename}}</a>
            <span ng-if="!document.license && !security.hasSystem(resource.path)">{{image.filename}}</span>
            &nbsp;({{image.length | bytes }})</td>
      </tr>
      </table>
      
      <!--<h3>Medium quality</h3>
      <table>
      <tr ng-repeat="image in images"> 
          <td><md-icon title="{{image.length | bytes }} - {{image.type }}">image</md-icon></td>
          <td>
            <a ng-if="document.license || security.hasSystem(resource.path)" download ng-href="{{image.large(image,document)}}">{{ img.basename(image.filename) }}-3000.jpeg</a>
            <span ng-if="!document.license && !security.hasSystem(resource.path)">{{ img.basename(image.filename) }}-3000.jpeg</span>
          </td>
      </tr>
      </table>-->
      
      <div ng-if="!document.license && security.hasSystem(resource.path)">
        Note: The links abobe are ephemeral and cannot be shared...
      </div>
      
      <div ng-if="!document.license && restricted == false">
        WARN: No license 8and rest => false
      </div>
      
       <div ng-if="restricted == true && !document.license && !security.hasSystem(resource.path)">
        We cannot distribute this map, contact map section to request access
      </div>
      

  
 
   
  <section ng-if="document.license" xmlns:dct="http://purl.org/dc/terms/">

    <p ng-if="document.license =='http://creativecommons.org/publicdomain/mark/1.0/'">
      <a rel="license" href="http://creativecommons.org/publicdomain/mark/1.0/"><img src="//i.creativecommons.org/p/mark/1.0/88x31.png" style="border-style: none;" alt="Public Domain Mark" /></a>
      Karta over er eigd av alle (ikkje verna av opphavsrett)
      <!-- (<span property="dct:title">{</span>, av <a href="URI" rel="dct:creator"><span property="dct:title">AUTHOR1</span></a>),
      identifisert av <a href="URI2" rel="dct:publisher"><span property="dct:title">PERSON1</span></a>,
      -->
    </p>
    <p ng-if="document.license =='http://creativecommons.org/licenses/by/4.0/'">
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        <img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />
        <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/StillImage" property="dct:title" rel="dct:type">
          The map <a ng-href="archive/{{document.id}}">{{ img.title(document)}}</a>
        </span> is free to reuse by attributing <a xmlns:cc="http://creativecommons.org/ns#" ng-href="{{document.rightsHolder.uri }}"
        property="cc:attributionName" rel="cc:attributionURL">{{ attributionNames | json }}</a> and is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.      
    </p>
  </section> 
    

  <section ng-if="similar.maps.length > 0">

    <h3>See also</h3>

    <div>
      <ul>
        <li ng-repeat="m in similar.maps">
          <span ng-show="m.restricted == true">[restricted]</span>
          <span ng-show="false">{{ m._score}}</span>
          <a ng-href="archive/{{ m.id }}">{{ m.title }}</a> ({{ m.publication.year }}) - {{ m.type }}</li>
      </ul>
    </div>

  </section>

  <section ng-if="document.tags">
    <h3>Tags</h3>
    <span ng-repeat="tag in document.tags">
      <a href="?q={{tag}}">{{tag}}</a> /
    </span>
  </section>
  
  <section ng-if="document.publication.languages">
    <h3>Languages</h3>
    <span ng-repeat="code in document.publication.languages">
      {{ language(code) }}</a>
    </span>
  </section>
  
  <section ng-if="document.placenames">
    <h3>Placenames</h3>
    <span ng-repeat="p in document.placenames">
      <span ng-if="p.placename">
        <a ng-href="archive?q={{p.placename}}">{{p.placename}}</a>,
      </span>
      <span ng-if="p.area">
        <a ng-href="archive?q={{p.area}}">{{ p.area }}</a>,
      </span>
      <a ng-href="archive?filter-placenames.country={{p.country}}">{{ p.country }}</a>
    </span>
  </section>
  
  <section ng-if="document.contributors">
    <npdc:persons></npdc:persons>
    <npdc:organisations></npdc:organisations>
  </section>
  


  <!--<md-divider></md-divider>

  
    <a ng-href="archive/{{document.id}}">{{ img.title(document)}}</a>

      was scanned by <a ng-href="?filter-processor.name={{document.processor.name }}">{{document.processor.name || document.created_by }}</a>,
      {{ editors(document.contributors) | json }}
      updated {{document.updated.split('T')[0] }} [revision number {{ document._rev.split('-')[0] }}]
    </p>
  
  -->

  <npdc:document-meta></npdc:document-meta>
  
</article>